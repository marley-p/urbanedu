glm(y ~ x_2, family = "binomial", data = .) %>%
tidy()
qplot(x_2, y, data = mnist_27$train)
fit<-loess(y~x_2,data=mnist_27$train)
fit<-loess(y~x_2,data=mnist_27$train)
mnist_27$train %>% ggplot(aes(x_2,y))+
geom_smooth()
mnist_27$train %>% ggplot(aes(x_2,y))+
geom_smooth(span=0.3)
mnist_27$train %>% ggplot(aes(x_2,y))+
geom_smooth(span=0.5)
dat<-mnist_27$train
View(mnist_27)
View(mnist_27)
View(dat)
fit<-loess(y~x_2,data=dat)
dat<-dat %>% mutate=(y=ifelse(7,1,0))
dat<-dat %>% mutate=(y=ifelse(y==7,1,0))
dat<- dat %>% mutate=(y=ifelse(y==7,1,0))
dat %>% mutate=(y=ifelse(y==7,1,0))
dat %>% mutate=(value=ifelse(y==7,1,0))
dat %>% mutate(value=ifelse(y==7,1,0))
dat<-dat %>% mutate(value=ifelse(y==7,1,0))
fit<-loess(value~x_2,data=dat)
dat<-dat %>% mutate(prob=fit$fitted)
View(dat)
dat %>% ggplot(aes(x_2,prob))+
geom_line()
dat%>% ggplot(aes(x_2,value))+
geom_smooth()
fit<-loess(value~x_2,degree=1,data=dat)
dat<-dat %>% mutate(prob=fit$fitted)
dat %>% ggplot(aes(x_2,prob))+
geom_line()
fit<-loess(value~x_2,degree=1,span=0.2,data=dat)
dat<-dat %>% mutate(prob=fit$fitted)
dat %>% ggplot(aes(x_2,prob))+
geom_line()
library(broom)
library(dslabs)
library(tidyverse)
library(generics)
library(tidyr)
library(caret)
set.seed(1996)
n <- 1000
p <- 10000
x <- matrix(rnorm(n * p), n, p)
colnames(x) <- paste("x", 1:ncol(x), sep = "_")
y <- rbinom(n, 1, 0.5) %>% factor()
x_subset <- x[ ,sample(p, 100)]
View(x)
View(x_subset)
print(y)
train(x_subset,y,method='vglmAdjCat')
set.seed(1995)
indexes <- createResample(mnist_27$train$y, 10)
set.seed(1995)
indexes <- createResample(mnist_27$train$y, 10)
View(indexes)
indexes[1]
view(mnist_27$train)
View(indexes)
view(indexes[1])
indexes[1]$value
View(indexes)
resample1<-indexes[1]
View(resample1)
resample1<-indexes[[1]]
sum(resample1==1:9)
sum(resample1==1)
sum(resample1==1)
sum(resample1==3)
sum(resample1==4)
sum(resample1==7)
y <- rnorm(100, 0, 1)
qnorm(0.75)
quantile(y, 0.75)
B<-10000
monte<-replicate(B,{
x<-rnorm(100, 0, 1)
mean(x)
})
mean(monte)
sd(monte)
boot<-replicate(10,{
x<-sample(y,100,replace=TRUE)
mean(x)
})
mean(boot)
sd(boot)
boot<-replicate(B,{
x<-sample(y,100,replace=TRUE)
mean(x)
})
mean(boot)
sd(boot)
library(tidyverse)
library(educationdata)
admit_df<-read.csv("admit.csv")
earnings_df<-read.csv("earnings.csv")
repay_df<-read.csv("repay.csv")
grad_final<-read.csv("grad.csv")
student_df<-read.csv("student.csv")
admit_df <- admit_df %>% unite(match,unitid,year,remove=FALSE) %>%
mutate(abb=state.abb[match(fips,state.name)])
earnings_short_df<-earnings_df %>% filter(years_after_entry==6|years_after_entry==7)
earnings_short_df <- earnings_short_df %>% unite(match,unitid,cohort_year,remove=FALSE)
earnings_short_df <- admit_df %>% right_join(earnings_short_df,by="match")
earnings_mid_df<-earnings_df%>% filter(years_after_entry==8)
earnings_mid_df <- earnings_mid_df %>% unite(match,unitid,cohort_year,remove=FALSE)
earnings_mid_df <- admit_df %>% right_join(earnings_mid_df,by="match")
earnings_long_df<-earnings_df%>% filter(years_after_entry==9|years_after_entry==10)
earnings_long_df <- earnings_long_df %>% unite(match,unitid,cohort_year,remove=FALSE)
earnings_long_df <- admit_df %>% left_join(earnings_long_df,by="match")
repay_5<-repay_df %>% filter(years_since_entering_repay==5)
repay_5<-repay_5%>% unite(match,unitid,cohort_year,remove=FALSE)
repay_5 <- admit_df %>% right_join(repay_5,by="match")
grad_df<-grad_final%>% unite(match,unitid,cohort_year,remove=FALSE)
grad_df <- admit_df %>% right_join(grad_df,by="match")
student_df<-student_df%>% unite(match,unitid,year,remove=FALSE)
student_df <- admit_df %>% right_join(student_df,by="match")
library(tidyverse)
library(ggrepel)
df_full<-earnings_short_df
df25<-df_full%>% filter(earnings_mean>0&sat_math_25_pctl>0)
df25 %>% ggplot(aes(y=earnings_mean,x=sat_math_25_pctl))+
geom_point()+
geom_smooth(method=lm,formula = y ~ x)
df75<-df_full%>% filter(earnings_mean>0&sat_math_75_pctl>0)
df75 %>% ggplot(aes(x=earnings_mean,y=sat_math_75_pctl))+
geom_point()+
geom_smooth(method=lm)
dfcrit<-df_full%>% filter(earnings_mean>0&sat_crit_read_25_pctl>0)
dfcrit %>% ggplot(aes(x=earnings_mean,y=sat_crit_read_25_pctl))+
geom_point()+
geom_smooth(method=lm)
dfwrit <- df_full%>% filter(earnings_mean>0&sat_writing_25_pctl>0)
dfwrit %>% ggplot(aes(x=earnings_mean,y=sat_writing_25_pctl))+
geom_point()+
geom_smooth(method=lm)
dfclean<-df_full %>% filter_at(vars(sat_math_25_pctl,sat_crit_read_25_pctl,sat_writing_25_pctl),all_vars(.>0))
sat_earnings_regress<-lm(earnings_mean~sat_crit_read_25_pctl+sat_writing_25_pctl+sat_math_25_pctl,data=dfclean)
summary(sat_earnings_regress)
sat_math_av<-mean(df25$sat_math_25_pctl)
sat_math_sd<-sd(df25$sat_math_25_pctl)
sat_crit_av<-mean(dfcrit$sat_crit_read_25_pctl)
sat_crit_sd<-sd(dfcrit$sat_crit_read_25_pctl)
sat_writ_av<-mean(dfwrit$sat_writing_25_pctl)
sat_writ_sd<-sd(dfwrit$sat_writing_25_pctl)
df_act_math<- df_full%>% filter(earnings_mean>0&act_math_25_pctl>0)
df_act_math %>% ggplot(aes(x=earnings_mean,y=act_math_25_pctl))+
geom_point()+
geom_smooth(method=lm)
df_act_english<- df_full%>% filter(earnings_mean>0&act_english_25_pctl>0)
act_math_av<-mean(df_act_math$act_math_25_pctl)
act_math_sd<-sd(df_act_math$act_math_25_pctl)
act_english_av<-mean(df_act_english$act_english_25_pctl)
act_english_sd<-sd(df_act_english$act_english_25_pctl)
df_act_english %>% ggplot(aes(x=earnings_mean,y=act_english_25_pctl))+
geom_point()+
geom_smooth(method=lm)
act_earnings_regress<-lm(earnings_mean~act_math_25_pctl+act_english_25_pctl,data=df_act_math)
summary(act_earnings_regress)
df_standard<-df_full %>% mutate(sat_math_25_stand=(sat_math_25_pctl-sat_math_av)/sat_math_sd,
sat_writ_25_stand=(sat_writing_25_pctl-sat_writ_av)/sat_writ_sd,
sat_crit_25_stand=(sat_crit_read_25_pctl-sat_crit_av)/sat_crit_sd,
act_math_25_stand=(act_math_25_pctl-act_math_av)/act_math_sd,
act_english_25_stand=(act_english_25_pctl-act_english_av)/act_english_sd)
df_na<- df_full %>% filter(is.na(sat_math_25_pctl))
mean(df_na$earnings_mean)
mean(df25$earnings_mean)
state_av <- df25 %>% filter(!is.na(abb)) %>%
group_by(abb) %>%
summarize(satmath25=mean(sat_math_25_pctl),income=mean(earnings_mean))
state_av %>% ggplot(aes(x=satmath25,y=income,label=abb)) +
geom_smooth(method=lm)+
geom_point()+
geom_text_repel()
df25 %>% ggplot(aes(y=earnings_mean,x=sat_math_25_pctl))+
geom_point(color="red",alpha=0.3)+
geom_smooth(method=lm,formula = y ~ x)
df25 %>% ggplot(aes(y=earnings_mean,x=sat_math_25_pctl))+
geom_point(color="red",alpha=0.1)+
geom_smooth(method=lm,formula = y ~ x)
df25 %>% ggplot(aes(y=earnings_mean,x=sat_math_25_pctl))+
geom_point(color="red",alpha=0.2)+
geom_smooth(method=lm,formula = y ~ x)
dfcrit %>% ggplot(aes(y=earnings_mean,x=sat_crit_read_25_pctl))+
geom_point(color="red",alpha=0.2)+
geom_smooth(method=lm,formula = y ~ x)
dfwrit %>% ggplot(aes(y=earnings_mean,x=sat_writing_25_pctl))+
geom_point(color="red",alpha=0.2)+
geom_smooth(method=lm,formula = y ~ x)
df_act_math %>% ggplot(aes(y=earnings_mean,x=act_math_25_pctl))+
geom_point(color="red",alpha=0.2)+
geom_smooth(method=lm,formula = y ~ x)
df_act_english %>% ggplot(aes(y=earnings_mean,x=act_english_25_pctl))+
geom_point(color="red",alpha=0.2)+
geom_smooth(method=lm,formula = y ~ x)
state_av %>% ggplot(aes(x=satmath25,y=income,label=abb)) +
geom_smooth(method=lm)+
geom_point()+
geom_text_repel()
View(admit_df)
View(student_df)
library(educationdata)
id_df<-get_education_data(level = 'college-university',
source = 'ipeds',
topic = 'directory',
filters=list(year=1997:2016),
add_labels = TRUE)
View(id_df)
write.csv(id_df,"id.csv")
write.csv(id_df,"id.csv")
grad_math<-grad_df %>% filter(sat_math_25_pctl>0, completion_rate_150pct>0)
grad_math %>% ggplot(aes(x=sat_math_25_pctl,y=completion_rate_150pct))+
geom_point()+
geom_smooth(method=lm)
grad_read<-grad_df %>% filter(sat_crit_read_25_pctl>0, completion_rate_150pct>0)
grad_read %>% ggplot(aes(x=sat_crit_read_25_pctl,y=completion_rate_150pct))+
geom_point()+
geom_smooth(method=lm)
grad_regress <-lm(completion_rate_150pct~sat_crit_read_25_pctl+sat_writing_25_pctl+sat_math_25_pctl,data=grad_df)
summary(grad_regress)
grad_missing<-grad_df %>% filter(is.na(sat_math_25_pctl))
mean(grad_missing$completion_rate_150pct,na.rm=TRUE)
mean(grad_math$completion_rate_150pct,na.rm=TRUE)
state_av <- grad_math %>% filter(!is.na(abb)) %>%
group_by(abb) %>%
summarize(satmath25=mean(sat_math_25_pctl),grad=mean(completion_rate_150pct))
state_av %>% ggplot(aes(x=satmath25,y=grad,label=abb)) +
geom_smooth(method=lm)+
geom_point()+
geom_text_repel()
repay_5_math<-repay_5 %>% filter(sat_math_25_pctl>0, repay_rate>0)
repay_5_math %>% ggplot(aes(x=sat_math_25_pctl,y=repay_rate))+
geom_point()+
geom_smooth(method=lm)
repay_5_read<-repay_5 %>% filter(sat_crit_read_25_pctl>0, repay_rate>0)
repay_5_read %>% ggplot(aes(x=sat_crit_read_25_pctl,y=repay_rate))+
geom_point()+
geom_smooth(method=lm)
repay_regress <-lm(repay_rate~sat_crit_read_25_pctl+sat_writing_25_pctl+sat_math_25_pctl,data=repay_5)
summary(repay_regress)
repay_na<- repay_5 %>% filter(is.na(sat_math_25_pctl),
repay_rate>0)
mean(repay_na$repay_rate,na.rm=TRUE)
mean(repay_5_math$repay_rate)
state_av <- repay_5_math %>% filter(!is.na(abb)) %>%
group_by(abb) %>%
summarize(satmath25=mean(sat_math_25_pctl),repay=mean(repay_rate_150pct))
state_av %>% ggplot(aes(x=satmath25,y=repay,label=abb)) +
geom_smooth(method=lm)+
geom_point()+
geom_text_repel()
repay_5_math<-repay_5 %>% filter(sat_math_25_pctl>0, repay_rate>0)
repay_5_math %>% ggplot(aes(x=sat_math_25_pctl,y=repay_rate))+
geom_point()+
geom_smooth(method=lm)
repay_5_read<-repay_5 %>% filter(sat_crit_read_25_pctl>0, repay_rate>0)
repay_5_read %>% ggplot(aes(x=sat_crit_read_25_pctl,y=repay_rate))+
geom_point()+
geom_smooth(method=lm)
repay_regress <-lm(repay_rate~sat_crit_read_25_pctl+sat_writing_25_pctl+sat_math_25_pctl,data=repay_5)
summary(repay_regress)
repay_na<- repay_5 %>% filter(is.na(sat_math_25_pctl),
repay_rate>0)
mean(repay_na$repay_rate,na.rm=TRUE)
mean(repay_5_math$repay_rate)
state_av <- repay_5_math %>% filter(!is.na(abb)) %>%
group_by(abb) %>%
summarize(satmath25=mean(sat_math_25_pctl),repay=mean(repay_rate))
state_av %>% ggplot(aes(x=satmath25,y=repay,label=abb)) +
geom_smooth(method=lm)+
geom_point()+
geom_text_repel()
df75 %>% ggplot(aes(y=earnings_mean,x=sat_math_75_pctl))+
geom_point()+
geom_smooth(method=lm)
df25 %>% ggplot(aes(y=earnings_mean,x=sat_math_25_pctl))+
geom_point(color="red",alpha=0.2)+
geom_smooth(method=lm,formula = y ~ x)+
labs(title =" New title", x = "New x", y = "New y")
df25 %>% ggplot(aes(y=earnings_mean,x=sat_math_25_pctl))+
geom_point(color="red",alpha=0.2)+
geom_smooth(method=lm,formula = y ~ x)+
labs(title ="SAT Math Score 25th Percentile vs Future Income", x = "SAT score", y = "Income/$")
dfcrit %>% ggplot(aes(y=earnings_mean,x=sat_crit_read_25_pctl))+
geom_point(color="red",alpha=0.2)+
geom_smooth(method=lm,formula = y ~ x)+
labs(title ="SAT Reading Score (25th Percentile) vs Future Income", x = "SAT score", y = "Income/$")
dfwrit %>% ggplot(aes(y=earnings_mean,x=sat_writing_25_pctl))+
geom_point(color="red",alpha=0.2)+
geom_smooth(method=lm,formula = y ~ x)+
labs(title ="SAT Writing Score (25th Percentile) vs Future Income", x = "SAT score", y = "Income/$")
sat_earnings_regress<-lm(earnings_mean~sat_crit_read_25_pctl+sat_writing_25_pctl+sat_math_25_pctl,data=dfclean)
summary(sat_earnings_regress)
state_av %>% ggplot(aes(x=satmath25,y=income,label=abb)) +
geom_smooth(method=lm)+
geom_point()+
geom_text_repel()
state_av <- df25 %>% filter(!is.na(abb)) %>%
group_by(abb) %>%
summarize(satmath25=mean(sat_math_25_pctl),income=mean(earnings_mean))
state_av %>% ggplot(aes(x=satmath25,y=income,label=abb)) +
geom_smooth(method=lm)+
geom_point()+
geom_text_repel()
state_av %>% ggplot(aes(x=satmath25,y=income,label=abb)) +
geom_smooth(method=lm)+
geom_point()+
geom_text_repel()+
labs(title ="State Average: Math Score vs Future Income", x = "SAT score", y = "Income/$")
student_math<-student_df %>% filter(sat_math_25_pctl>0, faminc_med>0)
student_math %>% ggplot(aes(x=sat_math_25_pctl,y=faminc_med))+
geom_point()+
geom_smooth(method=lm)
student_read<-student_df %>% filter(sat_crit_read_25_pctl>0, faminc_med>0)
student_read %>% ggplot(aes(x=sat_crit_read_25_pctl,y=faminc_med))+
geom_point()+
geom_smooth(method=lm)
student_regress <-lm(faminc_med~sat_crit_read_25_pctl+sat_writing_25_pctl+sat_math_25_pctl,data=student_df)
summary(student_regress)
student_earnings<- student_df %>% left_join(earnings_short_df,by="match")
student_earnings_cut<- student_earnings %>% filter(sat_math_25_pctl.x>0, faminc_med>0,earnings_mean>0)
student_earning_regress <-lm(earnings_mean~faminc_med+sat_crit_read_25_pctl.x+sat_writing_25_pctl.x+sat_math_25_pctl.x,data=student_earnings_cut)
summary(student_earning_regress)
student_earning_regress <-lm(earnings_mean~faminc_med+sat_math_25_pctl.x,data=student_earnings_cut)
summary(student_earning_regress)
student_earning_regress <-lm(earnings_mean~faminc_med,data=student_earnings_cut)
summary(student_earning_regress)
student_na<- student_df %>% filter(is.na(sat_math_25_pctl),
faminc_med>0)
mean(student_na$faminc_med,na.rm=TRUE)
mean(student_math$faminc_med)
student_earnings %>% ggplot(aes(x==faminc_med,y=earnings_mean))+
geom_point()+
geom_smooth(method=lm)
student_earnings %>% ggplot(aes(x=faminc_med,y=earnings_mean))+
geom_point()+
geom_smooth(method=lm)
student_earnings_cut %>% ggplot(aes(x=faminc_med,y=earnings_mean))+
geom_point()+
geom_smooth(method=lm)
student_earnings_cut %>% ggplot(aes(x=faminc_med,y=earnings_mean))+
geom_point(color="red",alpha=0.2)+
geom_smooth(method=lm)
grad_math<-grad_df %>% filter(sat_math_25_pctl>0, completion_rate_150pct>0)
grad_math %>% ggplot(aes(x=sat_math_25_pctl,y=completion_rate_150pct))+
geom_point()+
geom_smooth(method=lm)
grad_read<-grad_df %>% filter(sat_crit_read_25_pctl>0, completion_rate_150pct>0)
grad_read %>% ggplot(aes(x=sat_crit_read_25_pctl,y=completion_rate_150pct))+
geom_point()+
geom_smooth(method=lm)
grad_regress <-lm(completion_rate_150pct~sat_crit_read_25_pctl+sat_writing_25_pctl+sat_math_25_pctl,data=grad_df)
summary(grad_regress)
grad_missing<-grad_df %>% filter(is.na(sat_math_25_pctl))
mean(grad_missing$completion_rate_150pct,na.rm=TRUE)
mean(grad_math$completion_rate_150pct,na.rm=TRUE)
state_av <- grad_math %>% filter(!is.na(abb)) %>%
group_by(abb) %>%
summarize(satmath25=mean(sat_math_25_pctl),grad=mean(completion_rate_150pct))
state_av %>% ggplot(aes(x=satmath25,y=grad,label=abb)) +
geom_smooth(method=lm)+
geom_point()+
geom_text_repel()
repay_5_math<-repay_5 %>% filter(sat_math_25_pctl>0, repay_rate>0)
repay_5_math %>% ggplot(aes(x=sat_math_25_pctl,y=repay_rate))+
geom_point()+
geom_smooth(method=lm)
repay_5_read<-repay_5 %>% filter(sat_crit_read_25_pctl>0, repay_rate>0)
repay_5_read %>% ggplot(aes(x=sat_crit_read_25_pctl,y=repay_rate))+
geom_point()+
geom_smooth(method=lm)
repay_regress <-lm(repay_rate~sat_crit_read_25_pctl+sat_writing_25_pctl+sat_math_25_pctl,data=repay_5)
summary(repay_regress)
repay_na<- repay_5 %>% filter(is.na(sat_math_25_pctl),
repay_rate>0)
mean(repay_na$repay_rate,na.rm=TRUE)
mean(repay_5_math$repay_rate)
state_av <- repay_5_math %>% filter(!is.na(abb)) %>%
group_by(abb) %>%
summarize(satmath25=mean(sat_math_25_pctl),repay=mean(repay_rate))
state_av %>% ggplot(aes(x=satmath25,y=repay,label=abb)) +
geom_smooth(method=lm)+
geom_point()+
geom_text_repel()
repay_5_math %>% ggplot(aes(x=sat_math_25_pctl,y=repay_rate))+
geom_point()+
geom_smooth(method=glm)
repay_5_math %>% ggplot(aes(x=sat_math_25_pctl,y=repay_rate))+
geom_point()+
geom_smooth(method=glm)
repay_5_math %>% ggplot(aes(x=sat_math_25_pctl,y=repay_rate))+
geom_point()+
geom_smooth()
repay_regress <-glm(repay_rate~sat_crit_read_25_pctl+sat_writing_25_pctl+sat_math_25_pctl,data=repay_5)
summary(repay_regress)
repay_5_math %>% ggplot(aes(x=sat_math_25_pctl,y=repay_rate))+
geom_point()+
geom_smooth(method=glm,method.args=list(family="binomial"))
repay_5_math %>% ggplot(aes(x=sat_math_25_pctl,y=repay_rate))+
geom_point()+
geom_smooth(method=glm,method.args=list(family="quasibinomial"))
repay_regress <-glm(repay_rate~sat_crit_read_25_pctl+sat_writing_25_pctl+sat_math_25_pctl,data=repay_5,family="quasibinomial")
summary(repay_regress)
repay_regress <-glm(repay_rate~sat_crit_read_25_pctl+sat_writing_25_pctl+sat_math_25_pctl,data=repay_5,family="binomial")
summary(repay_regress)
repay_regress <-glm(repay_rate~sat_crit_read_25_pctl+sat_writing_25_pctl+sat_math_25_pctl,data=repay_5_math,family="binomial")
summary(repay_regress)
repay_5_math %>% ggplot(aes(x=sat_math_25_pctl,y=repay_rate))+
geom_point()+
geom_smooth(method=glm,method.args=list(family="binomial"))
state_av %>% ggplot(aes(x=satmath25,y=repay,label=abb)) +
geom_smooth(method=glm,method.args=list(family="binomial"))+
geom_point()+
geom_text_repel()
state_av %>% ggplot(aes(x=satmath25,y=repay,label=abb)) +
geom_smooth(method=glm,method.args=list(family="binomial"),se=FALSE)+
geom_point()+
geom_text_repel()
state_av %>% ggplot(aes(x=satmath25,y=repay,label=abb)) +
geom_smooth(method=glm,method.args=list(family="binomial"),se=FALSE)+
geom_point()+
geom_text_repel()+
labs(title ="State Average: Math Score vs Repayment Rate", x = "SAT score", y = "Repayment Rate")
repay_5_math %>% ggplot(aes(x=sat_math_25_pctl,y=repay_rate))+
geom_point()+
geom_smooth(method=glm,method.args=list(family="binomial"))+
labs(title ="Math Score vs Repayment Rate", x = "SAT score", y = "Repay Rate")
repay_5_math %>% ggplot(aes(x=sat_math_25_pctl,y=repay_rate))+
geom_point(color="red",alpha=0.2)+
geom_smooth(method=glm,method.args=list(family="binomial"))+
labs(title ="Math Score vs Repayment Rate", x = "SAT score", y = "Repay Rate")
grad_math<-grad_df %>% filter(sat_math_25_pctl>0, completion_rate_150pct>0)
grad_math %>% ggplot(aes(x=sat_math_25_pctl,y=completion_rate_150pct))+
geom_point()+
geom_smooth(method=lm)
grad_read<-grad_df %>% filter(sat_crit_read_25_pctl>0, completion_rate_150pct>0)
grad_read %>% ggplot(aes(x=sat_crit_read_25_pctl,y=completion_rate_150pct))+
geom_point()+
geom_smooth(method=lm)
grad_regress <-lm(completion_rate_150pct~sat_crit_read_25_pctl+sat_writing_25_pctl+sat_math_25_pctl,data=grad_df)
summary(grad_regress)
grad_missing<-grad_df %>% filter(is.na(sat_math_25_pctl))
mean(grad_missing$completion_rate_150pct,na.rm=TRUE)
mean(grad_math$completion_rate_150pct,na.rm=TRUE)
state_av <- grad_math %>% filter(!is.na(abb)) %>%
group_by(abb) %>%
summarize(satmath25=mean(sat_math_25_pctl),grad=mean(completion_rate_150pct))
state_av %>% ggplot(aes(x=satmath25,y=grad,label=abb)) +
geom_smooth(method=lm)+
geom_point()+
geom_text_repel()
grad_math %>% ggplot(aes(x=sat_math_25_pctl,y=completion_rate_150pct))+
geom_point(color="red",alpha=0.2)+
geom_smooth(method=glm,method.args=list(family="binomial"))+
labs(title ="Math Score vs Repayment Rate", x = "SAT score", y = "Repay Rate")
grad_read %>% ggplot(aes(x=sat_crit_read_25_pctl,y=completion_rate_150pct))+
geom_point(color="red",alpha=0.2)+
geom_smooth(method=glm,method.args=list(family="binomial"))+
labs(title ="Reading Score vs Graduation Rate", x = "SAT score", y = "Grad Rate")
grad_regress <-glm(completion_rate_150pct~sat_crit_read_25_pctl+sat_writing_25_pctl+sat_math_25_pctl,data=grad_df,family="binomial")
summary(grad_regress)
source('C:/Users/jack/projects/urbanedu/grad_analysis.R', echo=TRUE)
grad_regress <-glm(completion_rate_150pct~sat_crit_read_25_pctl+sat_writing_25_pctl+sat_math_25_pctl,data=grad_df,family="binomial")
summary(grad_regress)
state_av %>% ggplot(aes(x=satmath25,y=grad,label=abb)) +
geom_smooth(method=glm,method.args=list(family="binomial"),se=FALSE)+
labs(title ="State Avereage: Math Score vs Graduation Rate", x = "SAT score", y = "Grad Rate")+
geom_point()+
geom_text_repel()
state_av %>% ggplot(aes(x=satmath25,y=grad,label=abb)) +
geom_smooth(method=glm,method.args=list(family="binomial"),se=FALSE)+
labs(title ="State Average: Math Score vs Graduation Rate", x = "SAT score", y = "Grad Rate")+
geom_point()+
geom_text_repel()
View(repay_5_math)
View(earnings_mid_df)
student_earning_regress <-lm(earnings_mean~faminc_med+sat_math_25_pctl.x,data=student_earnings_cut)
summary(student_earning_regress)
student_earnings_cut %>% ggplot(aes(x=faminc_med,y=earnings_mean))+
geom_point(color="red",alpha=0.2)+
geom_smooth(method=lm)
student_math<-student_df %>% filter(sat_math_25_pctl>0, faminc_med>0)
student_income<-student_math %>% right_join(earnings_mid_df,by="match")
student_math %>% ggplot(aes(x=sat_math_25_pctl,y=faminc_med))+
geom_point()+
geom_smooth(method=lm)
student_read<-student_df %>% filter(sat_crit_read_25_pctl>0, faminc_med>0)
student_read %>% ggplot(aes(x=sat_crit_read_25_pctl,y=faminc_med))+
geom_point()+
geom_smooth(method=lm)
student_regress <-lm(faminc_med~sat_crit_read_25_pctl+sat_writing_25_pctl+sat_math_25_pctl,data=student_df)
summary(student_regress)
student_earnings<- student_df %>% left_join(earnings_short_df,by="match")
student_earnings_cut %>% ggplot(aes(x=faminc_med,y=earnings_mean))+
geom_point(color="red",alpha=0.2)+
geom_smooth(method=lm)
student_earnings_cut<- student_earnings %>% filter(sat_math_25_pctl.x>0, faminc_med>0,earnings_mean>0)
student_earning_regress <-lm(earnings_mean~faminc_med+sat_crit_read_25_pctl.x+sat_writing_25_pctl.x+sat_math_25_pctl.x,data=student_earnings_cut)
summary(student_earning_regress)
student_earning_regress <-lm(earnings_mean~faminc_med+sat_math_25_pctl.x,data=student_earnings_cut)
summary(student_earning_regress)
student_earning_regress <-lm(earnings_mean~faminc_med,data=student_earnings_cut)
summary(student_earning_regress)
student_na<- student_df %>% filter(is.na(sat_math_25_pctl),
faminc_med>0)
mean(student_na$faminc_med,na.rm=TRUE)
mean(student_math$faminc_med)
